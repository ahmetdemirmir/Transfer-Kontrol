<!-- ... (başlangıç kodları ve stiller aynı, sadece ilgili yerler değişti) ... -->
<style>
  /* ... önceki kodun stilleri ... */
  .qty-options {
    display: flex;
    gap: 6px;
    justify-content: center;
    margin-bottom: 12px;
  }
  .qty-btn {
    background: #eaeaea;
    color: #222;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
  }
  .qty-btn.selected, .qty-btn:active {
    background: #4a90e2;
    color: #fff;
  }
  .qty-btn.big {
    font-size: 30px;
    background: #e60000;
    color: #fff;
    min-width: 60px;
    height: 48px;
  }
  .qty-custom-input {
    width: 48px;
    font-size: 18px;
    text-align: center;
    margin-left: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
  .btn-green {
    background: linear-gradient(90deg, #ff8800 20%, #ffd966 100%);
    color: #222;
    border: none;
    padding: 18px 38px;
    font-size: 22px;
    font-weight: bold;
    border-radius: 10px;
    cursor: pointer;
    margin: 18px 8px 0 0;
    box-shadow: 0 4px 8px rgba(255,136,0,0.12);
    letter-spacing: 1px;
    transition: box-shadow 0.2s;
  }
  .btn-green:hover {
    box-shadow: 0 6px 12px rgba(255,136,0,0.23);
    background: linear-gradient(90deg, #ffd966 20%, #ff8800 100%);
  }
  .btn-red {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    margin: 10px 0 0 5px;
  }
  .btn-red.outline {
    background: #fff;
    color: #e74c3c;
    border: 2px solid #e74c3c;
    box-shadow: 0 0 0 2px #fff, 0 2px 8px rgba(231,76,60,0.12);
    transition: background 0.2s, color 0.2s;
  }
  .btn-red.outline:hover {
    background: #fceaea;
  }
  #product-price {
    font-size: 48px;
    color: #e60000;
    font-weight: 900;
    margin: 8px 0;
    letter-spacing: 1.5px;
  }
  #product-date {
    font-size: 24px;
    color: #5a0000;
    font-weight: 700;
    margin: 8px 0;
  }
</style>
<!-- ... -->
<div id="label-controls">
  <p>Kaç adet etiket basılsın?</p>
  <div class="qty-options" id="qtyOptions">
    <button class="qty-btn big selected" onclick="selectQty(1)">1</button>
    <button class="qty-btn" onclick="selectQty(2)">2</button>
    <button class="qty-btn" onclick="selectQty(3)">3</button>
    <button class="qty-btn" id="qtyCustomBtn" onclick="selectQty('custom')">Adet</button>
    <input type="number" min="1" max="99" id="qtyCustomInput" class="qty-custom-input" style="display:none;" value="1" oninput="selectQty('custom')" />
  </div>
  <label class="checkbox"><input type="checkbox" id="campaignCheck" /> Kampanyalı</label><br />
  <button class="btn-green" onclick="confirmLabel()">✔ Tamam</button>
  <button class="btn-red" onclick="closePopup()">✖ İptal</button>
</div>
<div id="error-controls" style="display:none;">
  <button class="btn-red outline" onclick="closePopup()">✖ Kapat</button>
</div>
<!-- ... -->

<script>
/* ... diğer kodlar aynı ... */
let selectedQty = 1;

function selectQty(qty) {
  document.querySelectorAll('.qty-btn').forEach(btn => btn.classList.remove('selected'));
  if (qty === 'custom') {
    document.getElementById('qtyCustomBtn').classList.add('selected');
    document.getElementById('qtyCustomInput').style.display = 'inline-block';
    selectedQty = parseInt(document.getElementById('qtyCustomInput').value) || 1;
  } else {
    selectedQty = qty;
    document.getElementById('qtyCustomInput').style.display = 'none';
    document.querySelectorAll('.qty-btn')[qty-1].classList.add('selected');
    document.getElementById('qtyCustomInput').value = qty;
  }
}

function confirmLabel() {
  let qty = selectedQty;
  if(document.getElementById('qtyCustomBtn').classList.contains('selected')) {
    qty = parseInt(document.getElementById('qtyCustomInput').value) || 1;
  }
  let isCampaign = document.getElementById("campaignCheck").checked;
  document.getElementById("popup").style.display = "none";
  if(!cameraActive) manualInput.focus();
}

function showPopup(product) {
  selectedProduct = product;
  const popupContent = document.getElementById("popupContent");
  popupContent.classList.remove("error");
  document.getElementById("product-name").innerText = product["Stok Adı"];
  document.getElementById("product-barcode").innerText = `Barkod: ${product["Barkodu"]}`;
  // TL simgesi fiyatın SONUNDA!
  document.getElementById("product-price").innerText = `Fiyat: ${product["MAĞAZA"]} ₺`;
  document.getElementById("product-date").innerText = `Fiyat Değişiklik Tarihi: ${product["Fiyat Değişiklik Tarihi"]}`;
  selectQty(1);
  document.getElementById("label-controls").style.display = "block";
  document.getElementById("error-controls").style.display = "none";
  document.getElementById("popup").style.display = "flex";
}

function playBeep(success = true) {
  // Sadece ses dosyası ile garantili, JS ile ton üretmek tarayıcıdan tarayıcıya değişir
  let beep = new Audio(success ? 'beep.ogg' : 'error.ogg');
  beep.play();
}
function onBarcodeDetected(data) {
  let code = data.codeResult.code;
  if(!code) return;
  Quagga.offDetected(onBarcodeDetected);

  // Barkod bulunduysa normal bip, bulunamadıysa error bip
  let found = excelData.find(item => String(item["Barkodu"]) === code);
  playBeep(!!found);
  vibrateDevice();

  logMessage(`Barkod okundu: ${code}`);
  addToScannedList(code);

  if(found) {
    showPopup(found);
  } else {
    showErrorPopup(code);
  }
  setTimeout(() => {
    Quagga.onDetected(onBarcodeDetected);
  }, 2000);
}
function showErrorPopup(code) {
  const popupContent = document.getElementById("popupContent");
  popupContent.classList.add("error");
  document.getElementById("product-name").innerText = "Ürün Bulunamadı!";
  document.getElementById("product-barcode").innerText = `Barkod: ${code}`;
  document.getElementById("product-price").innerText = "";
  document.getElementById("product-date").innerText = "";

  document.getElementById("label-controls").style.display = "none";
  document.getElementById("error-controls").style.display = "block";

  document.getElementById("popup").style.display = "flex";
  manualInput.value = "";
}
/* ... kalan kod aynı ... */
</script>
